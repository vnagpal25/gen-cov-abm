/home/namishah/alex/gen-cov-abm/covid_abm/substeps/new_transmission/transition.py:349: UserWarning: The use of `x.T` on tensors of dimension other than 2 to reverse their shape is deprecated and it will throw an error in a future release. Consider `x.mT` to transpose batches of matrices or `x.permute(*torch.arange(x.ndim - 1, -1, -1))` to reverse the dimensions of a tensor. (Triggered internally at /pytorch/aten/src/ATen/native/TensorShape.cpp:4416.)
  R = (R_tensor.T * week_one_hot).sum()
Traceback (most recent call last):
  File "/sw/pkgs/arc/python/3.10.4/lib/python3.10/runpy.py", line 196, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/sw/pkgs/arc/python/3.10.4/lib/python3.10/runpy.py", line 86, in _run_code
    exec(code, run_globals)
  File "/home/namishah/alex/gen-cov-abm/covid_abm/run_calib_nn.py", line 301, in <module>
    main()
  File "/home/namishah/alex/gen-cov-abm/covid_abm/run_calib_nn.py", line 287, in main
    train_county_window(
  File "/home/namishah/alex/gen-cov-abm/covid_abm/run_calib_nn.py", line 185, in train_county_window
    runner.step(num_steps)
  File "/home/namishah/alex/gen-cov-abm/AgentTorch/agent_torch/core/runner.py", line 82, in step
    next_state = self.controller.progress(
  File "/home/namishah/alex/gen-cov-abm/AgentTorch/agent_torch/core/controller.py", line 57, in progress
    **transition_function[substep][trans_func](
  File "/home/namishah/.venvs/covid/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1775, in _wrapped_call_impl
    return self._call_impl(*args, **kwargs)
  File "/home/namishah/.venvs/covid/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1786, in _call_impl
    return forward_call(*args, **kwargs)
  File "/home/namishah/alex/gen-cov-abm/covid_abm/substeps/new_transmission/transition.py", line 337, in forward
    week_one_hot = self._generate_one_hot_tensor(week_id, self.num_weeks)
  File "/home/namishah/alex/gen-cov-abm/covid_abm/substeps/new_transmission/transition.py", line 131, in _generate_one_hot_tensor
    one_hot_tensor = F.one_hot(timestep_tensor, num_classes=num_timesteps)
RuntimeError: Class values must be smaller than num_classes.
